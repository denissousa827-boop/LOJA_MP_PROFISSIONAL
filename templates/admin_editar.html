<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if produto %}Editar{% else %}Adicionar{% endif %} Produto</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 20px; background-color: #f4f7f6; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        h2 { border-bottom: 2px solid #007bff; padding-bottom: 10px; color: #333; }
        h3 { margin-top: 25px; color: #444; border-left: 4px solid #007bff; padding-left: 10px; }
        label { display: block; margin-top: 15px; font-weight: bold; color: #444; }
        input[type="text"], input[type="number"], textarea, input[type="file"], input[type="datetime-local"], select {
            width: 100%; padding: 12px; margin-top: 5px; box-sizing: border-box;
            border: 1px solid #ddd; border-radius: 8px; font-size: 16px;
            background-color: white;
        }
        .oferta-box {
            border: 2px dashed #ff4757; padding: 20px; margin: 25px 0;
            background-color: #fffaf0; border-radius: 10px;
        }
        .logistica-box {
            border: 2px solid #3483fa; padding: 20px; margin: 25px 0;
            background-color: #f0f5ff; border-radius: 10px;
        }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        button[type="submit"] {
            margin-top: 30px; width: 100%; padding: 15px;
            background-color: #2ed573; color: white; border: none;
            border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer;
            transition: 0.3s;
        }
        button[type="submit"]:hover { background-color: #26af5f; transform: scale(1.01); }
        .current-file { font-size: 12px; color: #666; margin-top: 5px; background: #eee; padding: 4px; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <h2>{% if produto %}Editar: {{ produto.nome }}{% else %}Adicionar Novo Produto{% endif %}</h2>
        <p><a href="{{ url_for('admin_dashboard') }}" style="text-decoration: none; color: #007bff; font-weight: bold;">‚Üê Voltar ao Painel</a></p>

        <form method="POST" enctype="multipart/form-data">
            <label for="id">ID do Produto (Sem espa√ßos):</label>
            <input type="text" id="id" name="id" value="{{ produto.id if produto else '' }}" {% if produto %}readonly style="background:#eee;"{% endif %} required>

            <label for="nome">Nome do Produto:</label>
            <input type="text" id="nome" name="nome" value="{{ produto.nome if produto else '' }}" required>

            <label for="categoria">Categoria do Produto:</label>
            <select id="categoria" name="categoria" required>
                <option value="" disabled {% if not produto %}selected{% endif %}>Selecione uma categoria</option>
                <option value="Celulares" {% if produto and produto.categoria == 'Celulares' %}selected{% endif %}>Celulares</option>
                <option value="Brinquedos" {% if produto and produto.categoria == 'Brinquedos' %}selected{% endif %}>Brinquedos</option>
                <option value="Roupas" {% if produto and produto.categoria == 'Roupas' %}selected{% endif %}>Moda / Roupas</option>
                <option value="Eletro" {% if produto and produto.categoria == 'Eletro' %}selected{% endif %}>Eletro / Cozinha</option>
                <option value="Beleza" {% if produto and produto.categoria == 'Beleza' %}selected{% endif %}>Beleza / Sa√∫de</option>
                <option value="Games" {% if produto and produto.categoria == 'Games' %}selected{% endif %}>Games</option>
                <option value="Ferramentas" {% if produto and produto.categoria == 'Ferramentas' %}selected{% endif %}>Ferramentas / Oficina</option>
                <option value="Casa" {% if produto and produto.categoria == 'Casa' %}selected{% endif %}>Casa / Decora√ß√£o</option>
            </select>

            <label for="preco">Pre√ßo de Venda (R$):</label>
            <input type="number" id="preco" name="preco" step="0.01" value="{{ produto.preco if produto else '' }}" required>

            <label for="descricao">Descri√ß√£o Completa:</label>
            <textarea id="descricao" name="descricao" rows="5" required>{{ produto.descricao if produto else '' }}</textarea>

            <div class="logistica-box">
                <h3 style="margin-top:0; color: #3483fa;">üì¶ Log√≠stica e Benef√≠cios</h3>
                <div class="grid-2">
                    <div>
                        <label for="estoque">Estoque Atual:</label>
                        <input type="number" id="estoque" name="estoque" value="{{ produto.estoque if produto else '50' }}">
                    </div>
                    <div>
                        <label for="desconto_pix">Desconto no Pix (%):</label>
                        <input type="number" id="desconto_pix" name="desconto_pix" value="{{ produto.desconto_pix if produto else '0' }}">
                    </div>
                </div>
                
                <div class="grid-2">
                    <div>
                        <label for="frete_gratis_valor">Frete Gr√°tis acima de (R$):</label>
                        <input type="number" id="frete_gratis_valor" name="frete_gratis_valor" step="0.01" value="{{ produto.frete_gratis_valor if produto else '0.00' }}">
                    </div>
                    <div>
                        <label for="prazo_entrega">Prazo de Entrega (Texto):</label>
                        <input type="text" id="prazo_entrega" name="prazo_entrega" value="{{ produto.prazo_entrega if produto else '7 e 12/jan' }}" placeholder="Ex: 5 a 10 dias">
                    </div>
                </div>

                <label for="tempo_preparo">Tempo de Preparo/Postagem:</label>
                <input type="text" id="tempo_preparo" name="tempo_preparo" value="{{ produto.tempo_preparo if produto else '1 a 2 dias' }}">
            </div>

            <div class="oferta-box">
                <h3 style="margin-top:0; color: #ff4757;">üî• Oferta Rel√¢mpago</h3>
                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                    <input type="checkbox" name="em_oferta" value="1" style="width: 20px; height: 20px;" {% if produto and produto.em_oferta %}checked{% endif %}>
                    Ativar Modo Oferta (Cron√¥metro)
                </label>

                <label for="novo_preco">Pre√ßo Promocional (R$):</label>
                <input type="number" id="novo_preco" name="novo_preco" step="0.01" value="{{ produto.novo_preco if produto else '' }}">

                <label for="oferta_fim">A oferta expira em:</label>
                <input type="datetime-local" id="oferta_fim" name="oferta_fim" value="{{ produto.oferta_fim if produto else '' }}">
            </div>

            <h3>M√≠dia do Produto</h3>
            <div class="grid-2">
                {% for i in range(1, 5) %}
                    {% set field = 'img_path_' ~ i %}
                    <div>
                        <label>Imagem {{ i }}:</label>
                        {% if produto and produto[field] %}
                            <div class="current-file">üìÅ {{ produto[field].split('/')[-1] }}</div>
                        {% endif %}
                        <input type="file" name="imagem_{{ i }}" accept="image/*">
                    </div>
                {% endfor %}
            </div>

            <label>V√≠deo Demonstrativo:</label>
            {% if produto and produto.video_path %}
                <div class="current-file">üé• {{ produto.video_path.split('/')[-1] }}</div>
            {% endif %}
            <input type="file" name="video" accept="video/*">

            <button type="submit">üöÄ SALVAR TODAS AS ALTERA√á√ïES</button>
        </form>
    </div>
</body>
</html>
