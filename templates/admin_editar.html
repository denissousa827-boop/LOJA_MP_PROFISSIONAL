<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if produto %}Editar{% else %}Adicionar{% endif %} Produto</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        h2 { border-bottom: 2px solid #ccc; padding-bottom: 10px; }
        label { display: block; margin-top: 10px; font-weight: bold; }
        input[type="text"], input[type="number"], textarea {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            box-sizing: border-box;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button[type="submit"] {
            margin-top: 20px;
            padding: 10px 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .oferta-box {
            border: 2px solid darkred;
            padding: 15px;
            margin: 20px 0;
            background-color: #ffeaea;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h2>{% if produto %}Editar Produto: {{ produto.nome }}{% else %}Adicionar Novo Produto{% endif %}</h2>
    <p><a href="{{ url_for('admin_dashboard') }}">Voltar para o Dashboard</a></p>
    <hr>

    <form method="POST" enctype="multipart/form-data">

        <label for="id">ID do Produto (√önico):</label>
        <input type="text" id="id" name="id" 
               value="{% if produto %}{{ produto.get('id') }}{% endif %}" 
               {% if produto %}readonly{% else %}required{% endif %}><br>

        <label for="nome">Nome:</label>
        <input type="text" id="nome" name="nome" value="{% if produto %}{{ produto.get('nome') }}{% endif %}" required><br>

        <label for="preco">Pre√ßo Normal (R$):</label>
        <input type="number" id="preco" name="preco" step="0.01" value="{% if produto %}{{ produto.get('preco') }}{% endif %}" required><br>

        <label for="descricao">Descri√ß√£o:</label>
        <textarea id="descricao" name="descricao" rows="4" required>{% if produto %}{{ produto.get('descricao') }}{% endif %}</textarea><br>

        <hr>

        <div class="oferta-box">
            <h3>üî• Configura√ß√µes de Oferta Rel√¢mpago</h3>

            <label>
                <input type="checkbox" name="em_oferta" {% if produto and produto.get('em_oferta') %}checked{% endif %}> 
                **Ativar Produto em Oferta** (Marque esta caixa para ativar o pre√ßo especial)
            </label>
            
            <label for="novo_preco">Novo Pre√ßo (R$ da Oferta):</label>
            <input type="number" id="novo_preco" name="novo_preco" step="0.01" 
                   value="{% if produto and produto.get('novo_preco') %}{{ produto['novo_preco'] }}{% endif %}" 
                   placeholder="Ex: 99.90 (S√≥ ser√° usado se a caixa acima estiver marcada)">
            
            <label for="oferta_fim">Data e Hora de Fim da Oferta (YYYY-MM-DD HH:MM:SS):</label>
            <input type="text" id="oferta_fim" name="oferta_fim" 
                   value="{% if produto and produto.get('oferta_fim') %}{{ produto['oferta_fim'] }}{% endif %}" 
                   placeholder="Ex: 2026-01-01 10:00:00 (Obrigat√≥rio para o cron√¥metro)">
        </div>
        
        <hr>
        
        <h3>M√≠dia (4 Imagens + 1 V√≠deo)</h3>

        {% for i in range(1, 5) %}
            {% set img_path_key = 'img_path_' ~ i %}
            <label for="imagem_{{ i }}">Imagem {{ i }}:</label>
            {% if produto and produto[img_path_key] %}
                {% set filename = produto[img_path_key].split('/')[-1] %}
                <p>Arquivo atual: <a href="{{ url_for('static', filename='uploads/' + filename) }}" target="_blank">{{ filename }}</a></p>
            {% endif %}
            <input type="file" id="imagem_{{ i }}" name="imagem_{{ i }}" accept="image/*"><br>
        {% endfor %}

        <label for="video">V√≠deo:</label>
        {% if produto and produto['video_path'] %}
            {% set filename = produto['video_path'].split('/')[-1] %}
            <p>Arquivo atual: <a href="{{ url_for('static', filename='uploads/' + filename) }}" target="_blank">{{ filename }}</a></p>
        {% endif %}
        <input type="file" id="video" name="video" accept="video/*"><br><br>

        <button type="submit">Salvar Produto</button>
    </form>
</body>
</html>
