{% extends "base.html" %}

{% block content %}
<style>
    .cart-container { max-width: 1000px; margin: 40px auto; padding: 0 20px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    .cart-wrapper { display: grid; grid-template-columns: 1fr 350px; gap: 20px; }
    .cart-items-list { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
    .cart-item { display: flex; gap: 20px; padding: 20px 0; border-bottom: 1px solid #eee; position: relative; }
    .cart-item:last-child { border-bottom: none; }
    .cart-item img { width: 100px; height: 100px; object-fit: cover; border-radius: 8px; }
    .item-details { flex: 1; }
    .item-details h4 { margin: 0 0 10px; font-size: 18px; color: #333; }
    .btn-remove { color: #3483fa; background: none; border: none; font-size: 13px; cursor: pointer; padding: 0; font-weight: 600; text-decoration: none; }
    .btn-remove:hover { color: #ff4757; }
    
    .summary-card { background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); height: fit-content; }
    .summary-title { font-size: 20px; font-weight: bold; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
    .summary-row { display: flex; justify-content: space-between; margin-bottom: 15px; color: #666; }
    .total-row { display: flex; justify-content: space-between; margin-top: 20px; padding-top: 20px; border-top: 2px solid #eee; font-size: 20px; font-weight: bold; color: #333; }
    
    .btn-confirm { background: #3483fa; color: white; width: 100%; border: none; padding: 18px; border-radius: 8px; font-weight: bold; font-size: 16px; cursor: pointer; text-decoration: none; display: block; text-align: center; margin-top: 25px; transition: 0.3s; }
    .btn-confirm:hover { background: #2968c8; transform: translateY(-2px); }

    @media (max-width: 850px) { .cart-wrapper { grid-template-columns: 1fr; } }
</style>

<div class="cart-container">
    <h1 style="margin-bottom: 30px; font-size: 24px;">Carrinho de Compras</h1>

    {% if produtos %}
    <div class="cart-wrapper">
        <div class="cart-items-list">
            {% for produto in produtos %}
            <div class="cart-item">
                <img src="{{ produto.img_path_1 }}" alt="{{ produto.nome }}">
                <div class="item-details">
                    <h4>{{ produto.nome }}</h4>
                    <p style="color: #00a650; font-size: 14px; margin-bottom: 15px;">Frete Grátis disponível</p>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <a href="{{ url_for('remover_carrinho', id_produto=produto.id) }}" class="btn-remove">Remover</a>
                        <span style="font-weight: bold; font-size: 18px;">{{ produto.quantidade_carrinho }}x R$ {{ "%.2f"|format(produto.subtotal / produto.quantidade_carrinho)|replace('.', ',') }}</span>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <div class="summary-card">
            <div class="summary-title">Resumo da compra</div>
            <div class="summary-row">
                <span>Produtos ({{ produtos|length }})</span>
                <span>R$ {{ "%.2f"|format(total)|replace('.', ',') }}</span>
            </div>
            <div class="summary-row">
                <span>Envio</span>
                <span style="color: #00a650;">Grátis</span>
            </div>
            <div class="total-row">
                <span>Total</span>
                <span>R$ {{ "%.2f"|format(total)|replace('.', ',') }}</span>
            </div>
            
            <a href="{{ url_for('checkout', id_produto=produtos[0].id) }}" class="btn-confirm">Finalizar Compra</a>
            <p style="text-align: center; font-size: 12px; color: #99.9; margin-top: 15px;">IVA incluso (quando aplicável)</p>
        </div>
    </div>
    {% else %}
    <div style="text-align: center; background: white; padding: 60px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05);">
        <i class="fas fa-shopping-basket" style="font-size: 60px; color: #eee; margin-bottom: 20px;"></i>
        <h2>Seu carrinho está vazio</h2>
        <p style="color: #666; margin-bottom: 30px;">Parece que você ainda não adicionou produtos ao seu carrinho.</p>
        <a href="{{ url_for('homepage') }}" class="btn-confirm" style="display: inline-block; width: auto; padding: 15px 50px;">Ver Ofertas do Dia</a>
    </div>
    {% endif %}
</div>
{% endblock %}
